# 데이터 가공

- 수집한 데이터를 추출, 정렬, 결합, 변형, 정제 등의 작업을 하는 과정

## 주요 내용
1. dplyr 패키지
    - 데이터 추출  : filter(), select()
    - 데이터 정렬  : arrange()
    - 데이터 추가  : mutate()
    - 중복 제거    : distinct()
    - 데이터 요약  : summarise(), group_by()
    - 샘플 추출    : sample_n(), sample_frac()

2. 파이프 연산자 : %>%

3. 데이터 결합 
    - 세로 결합     : bind_rows()
    - 가로 결합     : left_join(), right_join(), full_join()

4. 데이터 변형 (reshape2)
    - melt()
    - cast()
    - dcast()
    - acast()

5. 데이터 정제
    - 수집한 데이터 중 결측치와 이상치를 처리하는 과정
    - 결측치 : 데이터가 없음 (NA)
    - 이상치 : 데이터가 정상적인 범위에서 벗어난 값. "이상한 값"
              * 데이터 분석의 결과를 왜곡할 수 있다.


## dplyr 패키지
- 설치 및 로드
```
    install.packages('dplyr')
    library(dplyr)
```

- 유의사항 : 다른 패키지와 함수명이 중복되는 경우가 발생
  * 함수호출 시, 패키지명으로 구분하여 호출해주어야한다.
  * 패키지명::함수명()

### 데이터 추출
- 함수 : filter(데이터, 조건)
- 특정 조건에 맞는 데이터를 추출하는 함수

- 함수 : select(데이터, 변수1, 변수2, ...)
- 지정한 변수만 추출하는 함수


## 데이터 정렬
- 함수 : arrange(데이터, 변수1, 변수2, ...)
- 지정한 변수를 기준으로 오름차순 정렬하는 함수
- 내림차순 : desc(변수)


## 데이터 추가
- 열 추가하기
- 함수 : mutate( 데이터, 추가변수명=조건, ..)


## 중복 데이터 제거
- 함수 : distinct(데이터, 변수1, 변수2, ... )
- 여러 개의 변수를 지정하여 중복을 제거 할 수 있다
- 여러 개의 변수로 중복제거 시, 여러 변수 값의 조합이 동일한 경우만 제거한다.


## 데이터 요약
- 함수 : summarise( 데이터, 요약할 변수명=통계함수명 )
- summarise 함수는 기술통계 함수랑 함께 사용


## 그룹별로 요약
- 함수 : group_by(데이터, 변수명)
- 지정한 조건에 따라 그룹별로 데이터를 요약하는 함수


## 샘플 추출하기
- 수집한 데이터에서 개수를 지정하거나, 비율을 지정하여 데이터를 추출하는 것

- 함수 : sample_n(데이터, 개수)     - 개수 기준

- 함수 : sample_frac(데이터, 비율)  - 비율 기준


## 파이프 연산자 - %>%
- 먼저 작성된 함수 결과를 다시 다음 함수의 인자로 연결하는 연산자
- 형태
    - 데이터 세트 %>% 조건 %>% 데이터 세트
    - 함수 %>% 다음함수
- 함수를 연달아 사용하여 복잡해지는 코드를 간결하게 만들어준다.
- 단축키 : shift + ctrl + m



## 데이터 결합하기

### 세로 결합     
- 함수 : bind_rows(테이블1, 테이블2)
- 각 테이블의 변수명을 기준으로 데이터를 결합하는 함수
- 공통되는 변수가 아닌 경우에도 변수가 추가되어 결합된다
    A(a,b) + B(a,b,c)  = C(a,b,c)
    * A테이블에는 c변수가 없으므로, 결측치(NA)로 데이터가 추가된다




### 가로 결합   
- 두 데이터 세트의 공통 변수(컬럼)을 기준으로 외부, 내부 조인하는 것
- 형태 : 함수(데이터세트1, 데이터세트2, by = "조인기준 변수")  
- 함수 
    * 내부 조인
        - inner_join() : 지정한 변수를 기준으로 내부조인을 하는 함수
    * 외부 조인
        - left_join()   : 왼쪽과 조인기준이 일치하는 오른쪽 데이터를 결합하는 함수
        - right_join()  : 오른쪽과 조인기준이 일치하는 왼쪽 데이터를 결합하는 함수
        - full_join()   : 조인 기준에 따라 왼쪽, 오른쪽 데이터 세트를 결합하는 함수
        * 조인기준이 일치하지 않는 경우, 반대쪽 데이터 세트의 값이 MISSING 지정된다

- 데이터 세트
    - 제주지역 17년 카드 이용금액 - Sample4_~
    - 제주지역 16년 카드 이용금액 - Sample5_~